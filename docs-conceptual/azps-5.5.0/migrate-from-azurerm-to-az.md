---
title: Перенос скриптов Azure PowerShell с AzureRM на Az
description: Узнайте о действиях и инструментах для переноса скриптов Azure PowerShell с модуля AzureRM на новый модуль Az PowerShell.
ms.devlang: powershell
ms.service: azure-powershell
ms.topic: conceptual
ms.date: 12/15/2020
ms.custom: devx-track-azurepowershell, contperf-fy21q2
ms.openlocfilehash: 6bccaf9a628f67b8945516bae70f07939cdce8f7
ms.sourcegitcommit: c05d3d669b5631e526841f47b22513d78495350b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/09/2021
ms.locfileid: "100012157"
---
# <a name="migrate-azure-powershell-from-azurerm-to-az"></a><span data-ttu-id="f9397-103">Перенос Azure PowerShell с AzureRM на Az</span><span class="sxs-lookup"><span data-stu-id="f9397-103">Migrate Azure PowerShell from AzureRM to Az</span></span>

<span data-ttu-id="f9397-104">Все версии модуля AzureRM PowerShell устарели.</span><span class="sxs-lookup"><span data-stu-id="f9397-104">All versions of the AzureRM PowerShell module are outdated.</span></span> <span data-ttu-id="f9397-105">[Модуль Az PowerShell](install-az-ps.md) теперь является рекомендуемым модулем PowerShell для взаимодействия с Azure.</span><span class="sxs-lookup"><span data-stu-id="f9397-105">The [Az PowerShell module](install-az-ps.md) is now the recommended PowerShell module for interacting with Azure.</span></span>

## <a name="why-a-new-module"></a><span data-ttu-id="f9397-106">Преимущества нового модуля</span><span class="sxs-lookup"><span data-stu-id="f9397-106">Why a new module?</span></span>

<span data-ttu-id="f9397-107">Самое большое и важное изменение заключается в том, что [PowerShell](/powershell/scripting/overview) является кросс-платформенным продуктом на основе библиотеки .NET Standard с момента своего появления.</span><span class="sxs-lookup"><span data-stu-id="f9397-107">The biggest and most important change is that [PowerShell](/powershell/scripting/overview), being based on the .NET Standard library, has been a cross-platform product since its introduction.</span></span>

<span data-ttu-id="f9397-108">Как и в случае с PowerShell, мы стремимся обеспечить поддержку Azure на всех платформах.</span><span class="sxs-lookup"><span data-stu-id="f9397-108">Like the PowerShell language, we're committed to bringing Azure support to all platforms.</span></span> <span data-ttu-id="f9397-109">Поэтому мы обновили модули Azure PowerShell для обеспечения совместимости с .NET Standard и PowerShell Core.</span><span class="sxs-lookup"><span data-stu-id="f9397-109">Our commitment meant that the Azure PowerShell modules needed to be updated to use .NET Standard and be compatible with PowerShell Core.</span></span> <span data-ttu-id="f9397-110">Вместо того чтобы вносить в существующий модуль AzureRM сложные изменения для включения этой поддержки, был создан модуль Az.</span><span class="sxs-lookup"><span data-stu-id="f9397-110">Rather than modifying the existing AzureRM module and introducing complex changes to add this support, the Az module was created.</span></span>

<span data-ttu-id="f9397-111">Это решение также позволило нашим инженерам сделать разработку, модули и имена командлетов согласованными.</span><span class="sxs-lookup"><span data-stu-id="f9397-111">Creating a new module also allowed our engineers to make the design, naming of cmdlets, and modules consistent.</span></span> <span data-ttu-id="f9397-112">Все модули теперь начинаются с префикса `Az.`, а все командлеты следуют соглашению об именовании, определяющем формат `Verb-AzNoun`.</span><span class="sxs-lookup"><span data-stu-id="f9397-112">All modules now start with the `Az.` prefix and cmdlets all use the `Verb-AzNoun` naming convention.</span></span> <span data-ttu-id="f9397-113">Раньше имена командлетов были длинными и непоследовательными.</span><span class="sxs-lookup"><span data-stu-id="f9397-113">Previously, cmdlet names were longer and inconsistent.</span></span>

<span data-ttu-id="f9397-114">Количество модулей также уменьшилось — некоторые модули, предназначенные для одних и тех же служб, были объединены.</span><span class="sxs-lookup"><span data-stu-id="f9397-114">The number of modules were also reduced: Some modules that worked with the same services have been combined.</span></span> <span data-ttu-id="f9397-115">Командлеты плоскости управления и плоскости данных для одной службы теперь содержатся в отдельном модуле.</span><span class="sxs-lookup"><span data-stu-id="f9397-115">Management plane and data plane cmdlets for the same service are now contained within a single module.</span></span> <span data-ttu-id="f9397-116">Это упрощает задачу для тех, кто вручную управляет зависимостями и импортом.</span><span class="sxs-lookup"><span data-stu-id="f9397-116">For those of you who manually manage dependencies and imports, this consolidation makes things much simpler.</span></span>

<span data-ttu-id="f9397-117">Выполняя эти важные изменения, команда стремилась максимально упростить использование Azure с помощью командлетов PowerShell и добавить поддержку большего количества платформ, чем это было возможно ранее.</span><span class="sxs-lookup"><span data-stu-id="f9397-117">By making these important changes, the team has committed to making it easier than ever before and on more platforms than previously possible to use Azure with PowerShell cmdlets.</span></span>

## <a name="upgrading-to-az-powershell"></a><span data-ttu-id="f9397-118">Обновление до Az PowerShell</span><span class="sxs-lookup"><span data-stu-id="f9397-118">Upgrading to Az PowerShell</span></span>

<span data-ttu-id="f9397-119">Скрипты, написанные для командлетов AzureRM, не смогут автоматически работать с Az.</span><span class="sxs-lookup"><span data-stu-id="f9397-119">Scripts written for the AzureRM cmdlets won't automatically work with Az.</span></span> <span data-ttu-id="f9397-120">Чтобы упростить этот переход, был разработан [набор средств для миграции с AzureRM на Az](https://github.com/Azure/azure-powershell-migration).</span><span class="sxs-lookup"><span data-stu-id="f9397-120">To make the transition easier, the [AzureRM to Az migration toolkit](https://github.com/Azure/azure-powershell-migration) was developed.</span></span> <span data-ttu-id="f9397-121">Миграция всегда сопряжена со сложностями, и эта статья поможет вам начать переход на новый модуль Az PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f9397-121">No migration to a new command set is ever convenient, but this article will help you get started on transitioning to the Az PowerShell module.</span></span> <span data-ttu-id="f9397-122">Дополнительные сведения о том, для чего был создан модуль Az PowerShell, см. в статье [Знакомство с новым модулем Az для Azure PowerShell](new-azureps-module-az.md).</span><span class="sxs-lookup"><span data-stu-id="f9397-122">To learn more about why the Az PowerShell module was created, see [Introducing the new Azure PowerShell Az module](new-azureps-module-az.md).</span></span>

<span data-ttu-id="f9397-123">Новые имена командлетов выбраны таким образом, чтобы их было легко запомнить.</span><span class="sxs-lookup"><span data-stu-id="f9397-123">The new cmdlet names have been designed to be easy to learn.</span></span> <span data-ttu-id="f9397-124">Вместо имен командлетов `AzureRm` или `Azure` используйте `Az`.</span><span class="sxs-lookup"><span data-stu-id="f9397-124">Instead of using `AzureRm` or `Azure` in cmdlet names, use `Az`.</span></span> <span data-ttu-id="f9397-125">Например, вместо старого командлета `New-AzureRMVm` используется `New-AzVm`.</span><span class="sxs-lookup"><span data-stu-id="f9397-125">For example, the old cmdlet `New-AzureRMVm` has become `New-AzVm`.</span></span>
<span data-ttu-id="f9397-126">Но при переносе вам нужно не просто ознакомиться с новыми именами командлетов.</span><span class="sxs-lookup"><span data-stu-id="f9397-126">However, migration is more than just becoming familiar with the new cmdlet names, though.</span></span> <span data-ttu-id="f9397-127">Были переименованы модули, параметры и внесено много других важных изменений.</span><span class="sxs-lookup"><span data-stu-id="f9397-127">There are renamed modules, parameters, and other important changes.</span></span>

<span data-ttu-id="f9397-128">Полный список критических изменений между AzureRM и Az см. [здесь](migrate-az-1.0.0.md).</span><span class="sxs-lookup"><span data-stu-id="f9397-128">To see the full list of breaking changes between AzureRM and Az, see the [full changes from AzureRM to Az](migrate-az-1.0.0.md).</span></span>

## <a name="ensure-existing-scripts-work-with-the-latest-azurerm-release"></a><span data-ttu-id="f9397-129">Убедитесь, что существующие скрипты работают с последним выпуском AzureRM</span><span class="sxs-lookup"><span data-stu-id="f9397-129">Ensure existing scripts work with the latest AzureRM release</span></span>

<span data-ttu-id="f9397-130">Перед выполнением любых действий миграции проверьте, какие версии AzureRM установлены в вашей системе.</span><span class="sxs-lookup"><span data-stu-id="f9397-130">Before taking any migration steps, check which versions of AzureRM are installed on your system.</span></span>
<span data-ttu-id="f9397-131">Так вы проверите, запущены ли скрипты с последним выпуском, и узнаете, какие версии AzureRM необходимо удалить.</span><span class="sxs-lookup"><span data-stu-id="f9397-131">Doing so allows you to make sure scripts are already running on the latest release and let you know which versions of AzureRM must be uninstalled.</span></span>

<span data-ttu-id="f9397-132">Чтобы проверить установленные версии AzureRM, выполните приведенный ниже пример.</span><span class="sxs-lookup"><span data-stu-id="f9397-132">To check which version(s) of AzureRM you have installed, run the following example:</span></span>

```azurepowershell
Get-Module -Name AzureRM -ListAvailable -All
```

<span data-ttu-id="f9397-133">**Последний** доступный выпуск AzureRM — **6.13.1**.</span><span class="sxs-lookup"><span data-stu-id="f9397-133">The **latest** available release of AzureRM is **6.13.1**.</span></span> <span data-ttu-id="f9397-134">Если у вас нет этой версии, возможно, ваши существующие скрипты нужно будет изменить для работы с модулем Az наряду с изменениями, описанными в этой статье и [списке критических изменений](migrate-az-1.0.0.md).</span><span class="sxs-lookup"><span data-stu-id="f9397-134">If you don't have this version installed, your existing scripts may need additional modifications to work with the Az module beyond the scope of what's described in this article and in the [breaking changes list](migrate-az-1.0.0.md).</span></span>

<span data-ttu-id="f9397-135">Если скрипты не работают с AzureRM 6.13.1, обновите их в соответствии с [руководством по переходу AzureRM с версии 5.x на 6.x](/powershell/azure/azurerm/migration-guide.6.0.0).</span><span class="sxs-lookup"><span data-stu-id="f9397-135">If your scripts don't work with AzureRM 6.13.1, update them according to the [AzureRM 5.x to 6.x migration guide](/powershell/azure/azurerm/migration-guide.6.0.0).</span></span> <span data-ttu-id="f9397-136">Если вы используете более раннюю версию модуля AzureRM, найдите нужное руководство. Руководства по миграции существуют для каждого основного номера версии.</span><span class="sxs-lookup"><span data-stu-id="f9397-136">If you use an earlier version of the AzureRM module, there are migration guides available for each major version.</span></span>

## <a name="option-1-recommended-automatically-migrate-your-powershell-scripts"></a><span data-ttu-id="f9397-137">Вариант 1 (рекомендуется). Автоматический перенос скриптов PowerShell</span><span class="sxs-lookup"><span data-stu-id="f9397-137">Option 1 (recommended): Automatically migrate your PowerShell scripts</span></span>

<span data-ttu-id="f9397-138">Этот рекомендуемый вариант предполагает минимум усилий с вашей стороны для переноса скриптов AzureRM в Az.</span><span class="sxs-lookup"><span data-stu-id="f9397-138">This recommended option minimizes the effort required to migrate AzureRM scripts to Az.</span></span>

### <a name="install-the-azurerm-to-az-migration-toolkit"></a><span data-ttu-id="f9397-139">Установка набора средств для миграции с AzureRM на Az</span><span class="sxs-lookup"><span data-stu-id="f9397-139">Install the AzureRM to Az migration toolkit</span></span>

```azurepowershell
Install-Module -Name Az.Tools.Migration
```

### <a name="convert-your-scripts-automatically"></a><span data-ttu-id="f9397-140">Автоматическое преобразование скриптов</span><span class="sxs-lookup"><span data-stu-id="f9397-140">Convert your scripts automatically</span></span>

<span data-ttu-id="f9397-141">Используя набор средств для миграции с AzureRM на Az, вы можете подготовить план, который определяет изменения, которые будут внесены в скрипты до их внесения и установки модуля Az PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f9397-141">With the AzureRM to Az migration toolkit, you can generate a plan to determine what changes will be performed on your scripts before making any modifications to them and before installing the Az PowerShell module.</span></span>

<span data-ttu-id="f9397-142">В статье [Краткое руководство. Автоматическая миграция скриптов PowerShell из AzureRM в модуль Az PowerShell](quickstart-migrate-azurerm-to-az-automatically.md) показано, как выполнить автоматический перенос скриптов PowerShell из AzureRM в модуль Az PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f9397-142">The [Automatically migrate PowerShell scripts from AzureRM to the Az PowerShell module](quickstart-migrate-azurerm-to-az-automatically.md) quickstart walks you through the entire process of automatically updating your PowerShell scripts from AzureRM to the Az PowerShell module.</span></span>

## <a name="option-2-use-compatibility-mode-with-enable-azurermalias"></a><span data-ttu-id="f9397-143">Вариант 2. Использование режима совместимости с помощью Enable-AzureRmAlias</span><span class="sxs-lookup"><span data-stu-id="f9397-143">Option 2: Use compatibility mode with Enable-AzureRmAlias</span></span>

<span data-ttu-id="f9397-144">В модуле Az предусмотрен режим совместимости, который позволяет использовать существующие скрипты, пока вы выполняете обновление для нового синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="f9397-144">The Az module has a compatibility mode to help you use existing scripts while you update to the new syntax.</span></span> <span data-ttu-id="f9397-145">Командлет [Enable-AzureRmAlias](/powershell/module/az.accounts/enable-azurermalias) включает режим совместимости с использованием псевдонимов.</span><span class="sxs-lookup"><span data-stu-id="f9397-145">The [Enable-AzureRmAlias](/powershell/module/az.accounts/enable-azurermalias) cmdlet enables a compatibility mode through aliases.</span></span> <span data-ttu-id="f9397-146">Так вы сможете использовать существующие скрипты с минимальными изменениями во время подготовки к полному переходу на Az.</span><span class="sxs-lookup"><span data-stu-id="f9397-146">This mode allows you to use existing scripts with minimal modification while working towards a full migration to Az.</span></span> <span data-ttu-id="f9397-147">По умолчанию `Enable-AzureRmAlias` включает псевдонимы совместимости только для текущего сеанса PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f9397-147">By default, `Enable-AzureRmAlias` only enables compatibility aliases for the current PowerShell session.</span></span> <span data-ttu-id="f9397-148">Используйте его параметр `Scope`, чтобы псевдонимы совместимости поддерживались во всех сеансах PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f9397-148">Use its `Scope` parameter to persist compatibility aliases across PowerShell sessions.</span></span> <span data-ttu-id="f9397-149">Дополнительные сведения см. в справочной статье о командлете [Enable-AzureRmAlias](/powershell/module/az.accounts/enable-azurermalias).</span><span class="sxs-lookup"><span data-stu-id="f9397-149">For more information, see [the Enable-AzureRmAlias reference documentation](/powershell/module/az.accounts/enable-azurermalias).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f9397-150">Несмотря на то что для имен командлетов используются псевдонимы, все же могут существовать новые (или переименованные) параметры или измененные возвращаемые значения для командлетов Az.</span><span class="sxs-lookup"><span data-stu-id="f9397-150">Even though the cmdlet names are aliased, there may still be new (or renamed) parameters or changed return values for the Az cmdlets.</span></span> <span data-ttu-id="f9397-151">Не ожидайте, что активация псевдонимов обеспечит миграцию для вас.</span><span class="sxs-lookup"><span data-stu-id="f9397-151">Don't expect enabling aliases to take care of the migration for you!</span></span> <span data-ttu-id="f9397-152">Ознакомьтесь с [полным списком критических изменений](migrate-az-1.0.0.md), чтобы узнать, где в скриптах могут потребоваться обновления.</span><span class="sxs-lookup"><span data-stu-id="f9397-152">See the [full breaking changes list](migrate-az-1.0.0.md) to find where your scripts may require updates.</span></span>

## <a name="option-3-migrate-your-scripts-in-visual-studio-code-with-the-azure-powershell-extension"></a><span data-ttu-id="f9397-153">Способ 3. Перенос скриптов в Visual Studio Code с помощью расширения Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="f9397-153">Option 3: Migrate your scripts in Visual Studio Code with the Azure PowerShell extension</span></span>

### <a name="install-the-azure-powershell-extension-for-visual-studio-code"></a><span data-ttu-id="f9397-154">Установка расширения Azure PowerShell для Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="f9397-154">Install the Azure PowerShell extension for Visual Studio Code</span></span>

<span data-ttu-id="f9397-155">Установите [расширение Azure PowerShell для VS Code](https://marketplace.visualstudio.com/items?itemName=azps-tools.azps-tools).</span><span class="sxs-lookup"><span data-stu-id="f9397-155">Install the [Azure PowerShell extension for VSCode](https://marketplace.visualstudio.com/items?itemName=azps-tools.azps-tools)</span></span>

### <a name="convert-your-scripts-manually"></a><span data-ttu-id="f9397-156">Преобразование скриптов вручную</span><span class="sxs-lookup"><span data-stu-id="f9397-156">Convert your scripts manually</span></span>

1. <span data-ttu-id="f9397-157">Загрузите скрипт AzureRM в VS Code.</span><span class="sxs-lookup"><span data-stu-id="f9397-157">Load your AzureRM script in VSCode</span></span>
2. <span data-ttu-id="f9397-158">Начните миграцию, открыв палитру команд с помощью клавиш `Ctrl+Shift+P` и выбрав `Migrate Azure PowerShell script`.</span><span class="sxs-lookup"><span data-stu-id="f9397-158">Start the migration by opening the command palette `Ctrl+Shift+P` and select `Migrate Azure PowerShell script`</span></span>
3. <span data-ttu-id="f9397-159">Выберите исходную версию `AzureRM`.</span><span class="sxs-lookup"><span data-stu-id="f9397-159">Select source version `AzureRM`</span></span>
4. <span data-ttu-id="f9397-160">Выполните рекомендуемые действия для каждой команды или параметра.</span><span class="sxs-lookup"><span data-stu-id="f9397-160">Follow the recommended actions for each underlined command or parameter.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f9397-161">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="f9397-161">Next steps</span></span>

* [<span data-ttu-id="f9397-162">Удаление AzureRM</span><span class="sxs-lookup"><span data-stu-id="f9397-162">Uninstall AzureRM</span></span>](uninstall-az-ps.md#uninstall-the-azurerm-module)
* [<span data-ttu-id="f9397-163">Установка Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="f9397-163">Install Azure PowerShell</span></span>](install-az-ps.md)
