---
title: Перенос скриптов Azure PowerShell с AzureRM на Az
description: Сведения о действиях и инструментах для переноса скриптов с модуля AzureRM на новый модуль Az.
author: sptramer
ms.author: sttramer
manager: carmonm
ms.devlang: powershell
ms.topic: conceptual
ms.date: 12/13/2018
ms.openlocfilehash: 28122ca953d62b405f19effbbc680f2dc6202cca
ms.sourcegitcommit: 6685809f054203bd733c84f68acc69e53e5cca8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/02/2019
ms.locfileid: "53982949"
---
# <a name="migrate-from-azurerm-to-azure-powershell-az"></a>Миграция с AzureRM на Az для Azure PowerShell

Модуль Az имеет равенство функций с AzureRM, но использует более короткие и единообразные имена командлетов.
Скрипты, написанные для командлетов AzureRM, не смогут автоматически работать с новым модулем. Для упрощения перехода модуль Az предлагает средства, позволяющие запускать существующие скрипты, которые используют AzureRM. Миграция всегда сопряжена со сложностями, но эта статья поможет вам начать переход на новый модуль с новым набором команд.

Полный список критических изменений между AzureRM и Az см. в статье [Руководство по миграции для Az версии 1.0.0](migrate-az-1.0.0.md)

## <a name="check-for-installed-versions-of-azurerm"></a>Проверка наличия установленных версий AzureRM

Модуль Az можно установить параллельно с модулем AzureRM, но мы не рекомендуем делать это. Перед выполнением любых действий миграции проверьте, какие версии AzureRM установлены в вашей системе. Это позволит проверить, запущены ли скрипты с последним выпуском, и поможет понять, можете ли вы включить псевдонимы команд, не удаляя AzureRM.

Чтобы проверить установленную версию (версии) AzureRM, выполните приведенную ниже команду.

```powershell-interactive
Get-InstalledModule -Name AzureRM -AllVersions
```

## <a name="ensure-your-existing-scripts-work-with-the-latest-azurerm-release"></a>Убедитесь, что существующие скрипты работают с последним выпуском AzureRM

Это самый важный шаг. Запустите существующие скрипты и убедитесь, что они работают с _последним_ выпуском AzureRM (__6.13.1__). Если скрипты не работают, ознакомьтесь с [руководством по миграции AzureRM](/powershell/azure/azurerm/migration-guide.6.0.0).

## <a name="install-the-azure-powershell-az-module"></a>Установка модуля Az для Azure PowerShell

Первый шаг — это установка модуля Az на вашей платформе. При установке модуля Az рекомендуется удалить AzureRM. В последующих разделах вы узнаете, как продолжить использовать существующие скрипты и активировать режим совместимости со старыми именами командлетов.

Чтобы установить модуль Az для Azure PowerShell, выполните следующие шаги:

* __РЕКОМЕНДУЕТСЯ__: [Удалите модуль AzureRM](/powershell/azure/uninstall-az-ps#uninstall-the-azurerm-module).
  Убедитесь, что вы удалили _все_ установленные версии AzureRM, а не только самую последнюю.
* [Установите модуль Az](install-az-ps.md).

## <a name="a-namealiasesenable-azurerm-compatibility-aliases"></a><a name="aliases"/>Включение псевдонимов совместимости AzureRM 

> [!IMPORTANT]
>
> Включайте режим совместимости, только если вы удалили _все_ версии AzureRM. Включение режима совместимости с помощью все еще доступных командлетов AzureRM может привести к непредсказуемому поведению. Пропустите этот шаг, если вы решили не удалять AzureRM, но обратите внимание, что все командлеты AzureRM будут использовать старые модули и не будут вызывать командлетов Az.

Благодаря удаленной AzureRM и скриптам, работающим с последней версией AzureRM, можно активировать режим совместимости для модуля Az. Режим совместимости активируется следующей командой:

```powershell-interactive
Enable-AzureRmAlias -Scope CurrentUser
```

Псевдонимы позволяют использовать старые имена командлетов с установленным модулем Az. Эти псевдонимы записываются в профиль пользователя для выбранной области видимости. Если профиль пользователя отсутствует, он будет создан.

> [!WARNING]
>
> Можно использовать другое значение параметра `-Scope` для этой команды, но делать это не рекомендуется. Псевдонимы записываются в профиль пользователя для выбранной области видимости, поэтому используйте их для как можно более узкой области. Активация псевдонимов для всей системы может также вызвать проблемы у других пользователей, которые установили AzureRM в свою локальную область.

После активации режима псевдонимов запустите скрипты снова, чтобы убедиться, что они по-прежнему работают правильно. 

## <a name="change-module-imports-and-cmdlet-names"></a>Изменение импорта модулей и имен командлетов

В общем случае имена модулей были изменены таким образом, чтобы заменить `AzureRM` и `Azure` на `Az`. То же относится и к командлетам.
Например, модуль `AzureRM.Compute` был переименован в `Az.Compute`. `New-AzureRMVM` теперь называется `New-AzVM`, а `Get-AzureStorageBlob` — `Get-AzStorageBlob`.

Существует несколько исключений из этой схемы именования, о которых следует знать. Некоторые модули были переименованы или объединены с существующими модулями, что не повлияло на суффикс их командлетов, кроме изменения `AzureRM` или `Azure` на `Az`. В противном случае полный суффикс командлета был изменен в соответствии с новым именем модуля.

| Модуль AzureRM | Модуль Az | Изменен ли суффикс командлета? |
|----------------|-----------|------------------------|
| AzureRM.Profile | Az.Accounts | Yes |
| AzureRM.Insights; | Az.Monitor | Yes |
| AzureRM.DataFactories | Az.DataFactory | Yes |
| AzureRM.DataFactoryV2 | Az.DataFactory | Yes |
| AzureRM.RecoveryServices.Backup | Az.RecoveryServices | Нет  |
| AzureRM.RecoveryServices.SiteRecovery | Az.RecoveryServices | Нет  |
| AzureRM.Tags | Az.Resources | Нет  |
| AzureRM.MachineLearningCompute | Az.MachineLearning | Нет  |
| AzureRM.UsageAggregates | Az.Billing | Нет  |
| AzureRM.Consumption: | Az.Billing | Нет  |

## <a name="summary"></a>Сводка

Выполнив эти шаги, можно обновить все существующие скрипты для использования с новым модулем. Если у вас возникли вопросы по описанным действиям или же проблемы, которые затруднили миграцию, оставьте комментарии к этой статье, чтобы мы могли улучшить инструкции.
