---
title: Перенос скриптов Azure PowerShell с AzureRM на Az
description: Сведения о действиях и инструментах для переноса скриптов с модуля AzureRM на новый модуль Az.
author: sptramer
ms.author: sttramer
manager: carmonm
ms.devlang: powershell
ms.topic: conceptual
ms.date: 12/13/2018
ms.openlocfilehash: 28122ca953d62b405f19effbbc680f2dc6202cca
ms.sourcegitcommit: ae4540a90508db73335a54408dfd6cdf3712a1e9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59364274"
---
# <a name="migrate-from-azurerm-to-azure-powershell-az"></a><span data-ttu-id="6b4ee-103">Миграция с AzureRM на Az для Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="6b4ee-103">Migrate from AzureRM to Azure PowerShell Az</span></span>

<span data-ttu-id="6b4ee-104">Модуль Az имеет равенство функций с AzureRM, но использует более короткие и единообразные имена командлетов.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-104">The Az module has feature parity with AzureRM, but uses shorter and more consistent cmdlet names.</span></span>
<span data-ttu-id="6b4ee-105">Скрипты, написанные для командлетов AzureRM, не смогут автоматически работать с новым модулем.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-105">Scripts written for the AzureRM cmdlets won't automatically work with the new module.</span></span> <span data-ttu-id="6b4ee-106">Для упрощения перехода модуль Az предлагает средства, позволяющие запускать существующие скрипты, которые используют AzureRM.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-106">To make the transition easier, Az offers tools to allow you to run your existing scripts using AzureRM.</span></span> <span data-ttu-id="6b4ee-107">Миграция всегда сопряжена со сложностями, но эта статья поможет вам начать переход на новый модуль с новым набором команд.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-107">No migration to a new command set is ever convenient, but this article will help you get started on transitioning to the new module.</span></span>

<span data-ttu-id="6b4ee-108">Полный список критических изменений между AzureRM и Az см. в статье [Руководство по миграции для Az версии 1.0.0](migrate-az-1.0.0.md)</span><span class="sxs-lookup"><span data-stu-id="6b4ee-108">To see the full list of breaking changes between AzureRM and Az, see the [Migration guide for Az 1.0.0](migrate-az-1.0.0.md)</span></span>

## <a name="check-for-installed-versions-of-azurerm"></a><span data-ttu-id="6b4ee-109">Проверка наличия установленных версий AzureRM</span><span class="sxs-lookup"><span data-stu-id="6b4ee-109">Check for installed versions of AzureRM</span></span>

<span data-ttu-id="6b4ee-110">Модуль Az можно установить параллельно с модулем AzureRM, но мы не рекомендуем делать это.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-110">The Az module can be installed side-by-side with the AzureRM module, but this is not recommended.</span></span> <span data-ttu-id="6b4ee-111">Перед выполнением любых действий миграции проверьте, какие версии AzureRM установлены в вашей системе.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-111">Before taking any migration steps, check which versions of AzureRM are installed on your system.</span></span> <span data-ttu-id="6b4ee-112">Это позволит проверить, запущены ли скрипты с последним выпуском, и поможет понять, можете ли вы включить псевдонимы команд, не удаляя AzureRM.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-112">Doing so allows you to make sure scripts are already running on the latest release, and let you know if you can enable command aliases without uninstalling AzureRM.</span></span>

<span data-ttu-id="6b4ee-113">Чтобы проверить установленную версию (версии) AzureRM, выполните приведенную ниже команду.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-113">To check which version(s) of AzureRM you have installed, run the command:</span></span>

```powershell-interactive
Get-InstalledModule -Name AzureRM -AllVersions
```

## <a name="ensure-your-existing-scripts-work-with-the-latest-azurerm-release"></a><span data-ttu-id="6b4ee-114">Убедитесь, что существующие скрипты работают с последним выпуском AzureRM</span><span class="sxs-lookup"><span data-stu-id="6b4ee-114">Ensure your existing scripts work with the latest AzureRM release</span></span>

<span data-ttu-id="6b4ee-115">Это самый важный шаг.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-115">This is the most important step!</span></span> <span data-ttu-id="6b4ee-116">Запустите существующие скрипты и убедитесь, что они работают с _последним_ выпуском AzureRM (__6.13.1__).</span><span class="sxs-lookup"><span data-stu-id="6b4ee-116">Run your existing scripts, and make sure that they work with the _latest_ release of AzureRM (__6.13.1__).</span></span> <span data-ttu-id="6b4ee-117">Если скрипты не работают, ознакомьтесь с [руководством по миграции AzureRM](/powershell/azure/azurerm/migration-guide.6.0.0).</span><span class="sxs-lookup"><span data-stu-id="6b4ee-117">If your scripts don't work, make sure to read the [AzureRM migration guide](/powershell/azure/azurerm/migration-guide.6.0.0).</span></span>

## <a name="install-the-azure-powershell-az-module"></a><span data-ttu-id="6b4ee-118">Установка модуля Az для Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="6b4ee-118">Install the Azure PowerShell Az module</span></span>

<span data-ttu-id="6b4ee-119">Первый шаг — это установка модуля Az на вашей платформе.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-119">The first step is to install the Az module on your platform.</span></span> <span data-ttu-id="6b4ee-120">При установке модуля Az рекомендуется удалить AzureRM.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-120">When you install Az, it's recommended that you uninstall AzureRM.</span></span> <span data-ttu-id="6b4ee-121">В последующих разделах вы узнаете, как продолжить использовать существующие скрипты и активировать режим совместимости со старыми именами командлетов.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-121">In the following steps, you'll learn how to keep running your existing scripts and enable compatibility for old cmdlet names.</span></span>

<span data-ttu-id="6b4ee-122">Чтобы установить модуль Az для Azure PowerShell, выполните следующие шаги:</span><span class="sxs-lookup"><span data-stu-id="6b4ee-122">To install the Azure PowerShell Az module, follow these steps:</span></span>

* <span data-ttu-id="6b4ee-123">__РЕКОМЕНДУЕТСЯ__: [Удалите модуль AzureRM](/powershell/azure/uninstall-az-ps#uninstall-the-azurerm-module).</span><span class="sxs-lookup"><span data-stu-id="6b4ee-123">__RECOMMENDED__: [Uninstall the AzureRM module](/powershell/azure/uninstall-az-ps#uninstall-the-azurerm-module).</span></span>
  <span data-ttu-id="6b4ee-124">Убедитесь, что вы удалили _все_ установленные версии AzureRM, а не только самую последнюю.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-124">Make sure that you remove _all_ installed versions of AzureRM, not just the most recent version.</span></span>
* <span data-ttu-id="6b4ee-125">[Установите модуль Az](install-az-ps.md).</span><span class="sxs-lookup"><span data-stu-id="6b4ee-125">[Install the Az module](install-az-ps.md)</span></span>

## <a name="a-namealiasesenable-azurerm-compatibility-aliases"></a><span data-ttu-id="6b4ee-126"><a name="aliases"/>Включение псевдонимов совместимости AzureRM</span><span class="sxs-lookup"><span data-stu-id="6b4ee-126"><a name="aliases"/>Enable AzureRM compatibility aliases</span></span> 

> [!IMPORTANT]
>
> <span data-ttu-id="6b4ee-127">Включайте режим совместимости, только если вы удалили _все_ версии AzureRM.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-127">Only enable compatibility mode if you've uninstalled _all_ versions of AzureRM.</span></span> <span data-ttu-id="6b4ee-128">Включение режима совместимости с помощью все еще доступных командлетов AzureRM может привести к непредсказуемому поведению.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-128">Enabling compatibility mode with AzureRM cmdlets still available may result in unpredictable behavior.</span></span> <span data-ttu-id="6b4ee-129">Пропустите этот шаг, если вы решили не удалять AzureRM, но обратите внимание, что все командлеты AzureRM будут использовать старые модули и не будут вызывать командлетов Az.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-129">Skip this step if you decided to keep AzureRM installed, but be aware that any AzureRM cmdlets will use the older modules and not call any Az cmdlets.</span></span>

<span data-ttu-id="6b4ee-130">Благодаря удаленной AzureRM и скриптам, работающим с последней версией AzureRM, можно активировать режим совместимости для модуля Az.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-130">With AzureRM uninstalled and your scripts working with the latest AzureRM version, the next step is to enable the compatibility mode for the Az module.</span></span> <span data-ttu-id="6b4ee-131">Режим совместимости активируется следующей командой:</span><span class="sxs-lookup"><span data-stu-id="6b4ee-131">Compatibility is enabled with the command:</span></span>

```powershell-interactive
Enable-AzureRmAlias -Scope CurrentUser
```

<span data-ttu-id="6b4ee-132">Псевдонимы позволяют использовать старые имена командлетов с установленным модулем Az.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-132">Aliases enable the ability to use old cmdlet names with the Az module installed.</span></span> <span data-ttu-id="6b4ee-133">Эти псевдонимы записываются в профиль пользователя для выбранной области видимости.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-133">These aliases are written to the user profile for the selected scope.</span></span> <span data-ttu-id="6b4ee-134">Если профиль пользователя отсутствует, он будет создан.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-134">If no user profile exists, one is created.</span></span>

> [!WARNING]
>
> <span data-ttu-id="6b4ee-135">Можно использовать другое значение параметра `-Scope` для этой команды, но делать это не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-135">You can use a different `-Scope` for this command, but it's not recommended.</span></span> <span data-ttu-id="6b4ee-136">Псевдонимы записываются в профиль пользователя для выбранной области видимости, поэтому используйте их для как можно более узкой области.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-136">Aliases are written to the user profile for the selected scope, so keep enabling them to as limited a scope as possible.</span></span> <span data-ttu-id="6b4ee-137">Активация псевдонимов для всей системы может также вызвать проблемы у других пользователей, которые установили AzureRM в свою локальную область.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-137">Enabling aliases system-wide could also cause issues for other users which have AzureRM installed in their local scope.</span></span>

<span data-ttu-id="6b4ee-138">После активации режима псевдонимов запустите скрипты снова, чтобы убедиться, что они по-прежнему работают правильно.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-138">Once the alias mode is enabled, run your scripts again to confirm that they still function as expected.</span></span> 

## <a name="change-module-imports-and-cmdlet-names"></a><span data-ttu-id="6b4ee-139">Изменение импорта модулей и имен командлетов</span><span class="sxs-lookup"><span data-stu-id="6b4ee-139">Change module imports and cmdlet names</span></span>

<span data-ttu-id="6b4ee-140">В общем случае имена модулей были изменены таким образом, чтобы заменить `AzureRM` и `Azure` на `Az`. То же относится и к командлетам.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-140">In general, the module names have been changed so that `AzureRM` and `Azure` become `Az`, and the same for cmdlets.</span></span>
<span data-ttu-id="6b4ee-141">Например, модуль `AzureRM.Compute` был переименован в `Az.Compute`.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-141">For example, the `AzureRM.Compute` module has been renamed to `Az.Compute`.</span></span> <span data-ttu-id="6b4ee-142">`New-AzureRMVM` теперь называется `New-AzVM`, а `Get-AzureStorageBlob` — `Get-AzStorageBlob`.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-142">`New-AzureRMVM` has become `New-AzVM`, and `Get-AzureStorageBlob` is now `Get-AzStorageBlob`.</span></span>

<span data-ttu-id="6b4ee-143">Существует несколько исключений из этой схемы именования, о которых следует знать.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-143">There are exceptions to this naming change that you should be aware of.</span></span> <span data-ttu-id="6b4ee-144">Некоторые модули были переименованы или объединены с существующими модулями, что не повлияло на суффикс их командлетов, кроме изменения `AzureRM` или `Azure` на `Az`.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-144">Some modules were renamed or merged into existing modules without this affecting the suffix of their cmdlets, other than changing `AzureRM` or `Azure` to `Az`.</span></span> <span data-ttu-id="6b4ee-145">В противном случае полный суффикс командлета был изменен в соответствии с новым именем модуля.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-145">Otherwise, the full cmdlet suffix was changed to reflect the new module name.</span></span>

| <span data-ttu-id="6b4ee-146">Модуль AzureRM</span><span class="sxs-lookup"><span data-stu-id="6b4ee-146">AzureRM module</span></span> | <span data-ttu-id="6b4ee-147">Модуль Az</span><span class="sxs-lookup"><span data-stu-id="6b4ee-147">Az module</span></span> | <span data-ttu-id="6b4ee-148">Изменен ли суффикс командлета?</span><span class="sxs-lookup"><span data-stu-id="6b4ee-148">Cmdlet suffix changed?</span></span> |
|----------------|-----------|------------------------|
| <span data-ttu-id="6b4ee-149">AzureRM.Profile</span><span class="sxs-lookup"><span data-stu-id="6b4ee-149">AzureRM.Profile</span></span> | <span data-ttu-id="6b4ee-150">Az.Accounts</span><span class="sxs-lookup"><span data-stu-id="6b4ee-150">Az.Accounts</span></span> | <span data-ttu-id="6b4ee-151">Yes</span><span class="sxs-lookup"><span data-stu-id="6b4ee-151">Yes</span></span> |
| <span data-ttu-id="6b4ee-152">AzureRM.Insights;</span><span class="sxs-lookup"><span data-stu-id="6b4ee-152">AzureRM.Insights</span></span> | <span data-ttu-id="6b4ee-153">Az.Monitor</span><span class="sxs-lookup"><span data-stu-id="6b4ee-153">Az.Monitor</span></span> | <span data-ttu-id="6b4ee-154">Yes</span><span class="sxs-lookup"><span data-stu-id="6b4ee-154">Yes</span></span> |
| <span data-ttu-id="6b4ee-155">AzureRM.DataFactories</span><span class="sxs-lookup"><span data-stu-id="6b4ee-155">AzureRM.DataFactories</span></span> | <span data-ttu-id="6b4ee-156">Az.DataFactory</span><span class="sxs-lookup"><span data-stu-id="6b4ee-156">Az.DataFactory</span></span> | <span data-ttu-id="6b4ee-157">Yes</span><span class="sxs-lookup"><span data-stu-id="6b4ee-157">Yes</span></span> |
| <span data-ttu-id="6b4ee-158">AzureRM.DataFactoryV2</span><span class="sxs-lookup"><span data-stu-id="6b4ee-158">AzureRM.DataFactoryV2</span></span> | <span data-ttu-id="6b4ee-159">Az.DataFactory</span><span class="sxs-lookup"><span data-stu-id="6b4ee-159">Az.DataFactory</span></span> | <span data-ttu-id="6b4ee-160">Yes</span><span class="sxs-lookup"><span data-stu-id="6b4ee-160">Yes</span></span> |
| <span data-ttu-id="6b4ee-161">AzureRM.RecoveryServices.Backup</span><span class="sxs-lookup"><span data-stu-id="6b4ee-161">AzureRM.RecoveryServices.Backup</span></span> | <span data-ttu-id="6b4ee-162">Az.RecoveryServices</span><span class="sxs-lookup"><span data-stu-id="6b4ee-162">Az.RecoveryServices</span></span> | <span data-ttu-id="6b4ee-163">Нет </span><span class="sxs-lookup"><span data-stu-id="6b4ee-163">No</span></span> |
| <span data-ttu-id="6b4ee-164">AzureRM.RecoveryServices.SiteRecovery</span><span class="sxs-lookup"><span data-stu-id="6b4ee-164">AzureRM.RecoveryServices.SiteRecovery</span></span> | <span data-ttu-id="6b4ee-165">Az.RecoveryServices</span><span class="sxs-lookup"><span data-stu-id="6b4ee-165">Az.RecoveryServices</span></span> | <span data-ttu-id="6b4ee-166">Нет </span><span class="sxs-lookup"><span data-stu-id="6b4ee-166">No</span></span> |
| <span data-ttu-id="6b4ee-167">AzureRM.Tags</span><span class="sxs-lookup"><span data-stu-id="6b4ee-167">AzureRM.Tags</span></span> | <span data-ttu-id="6b4ee-168">Az.Resources</span><span class="sxs-lookup"><span data-stu-id="6b4ee-168">Az.Resources</span></span> | <span data-ttu-id="6b4ee-169">Нет </span><span class="sxs-lookup"><span data-stu-id="6b4ee-169">No</span></span> |
| <span data-ttu-id="6b4ee-170">AzureRM.MachineLearningCompute</span><span class="sxs-lookup"><span data-stu-id="6b4ee-170">AzureRM.MachineLearningCompute</span></span> | <span data-ttu-id="6b4ee-171">Az.MachineLearning</span><span class="sxs-lookup"><span data-stu-id="6b4ee-171">Az.MachineLearning</span></span> | <span data-ttu-id="6b4ee-172">Нет </span><span class="sxs-lookup"><span data-stu-id="6b4ee-172">No</span></span> |
| <span data-ttu-id="6b4ee-173">AzureRM.UsageAggregates</span><span class="sxs-lookup"><span data-stu-id="6b4ee-173">AzureRM.UsageAggregates</span></span> | <span data-ttu-id="6b4ee-174">Az.Billing</span><span class="sxs-lookup"><span data-stu-id="6b4ee-174">Az.Billing</span></span> | <span data-ttu-id="6b4ee-175">Нет </span><span class="sxs-lookup"><span data-stu-id="6b4ee-175">No</span></span> |
| <span data-ttu-id="6b4ee-176">AzureRM.Consumption:</span><span class="sxs-lookup"><span data-stu-id="6b4ee-176">AzureRM.Consumption</span></span> | <span data-ttu-id="6b4ee-177">Az.Billing</span><span class="sxs-lookup"><span data-stu-id="6b4ee-177">Az.Billing</span></span> | <span data-ttu-id="6b4ee-178">Нет </span><span class="sxs-lookup"><span data-stu-id="6b4ee-178">No</span></span> |

## <a name="summary"></a><span data-ttu-id="6b4ee-179">Сводка</span><span class="sxs-lookup"><span data-stu-id="6b4ee-179">Summary</span></span>

<span data-ttu-id="6b4ee-180">Выполнив эти шаги, можно обновить все существующие скрипты для использования с новым модулем.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-180">By following these steps, you can update all of your existing scripts to use the new module.</span></span> <span data-ttu-id="6b4ee-181">Если у вас возникли вопросы по описанным действиям или же проблемы, которые затруднили миграцию, оставьте комментарии к этой статье, чтобы мы могли улучшить инструкции.</span><span class="sxs-lookup"><span data-stu-id="6b4ee-181">If you have any questions or problems with these steps that made your migration difficult, please comment on this article so that we can improve the instructions.</span></span>
